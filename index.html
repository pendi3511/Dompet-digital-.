<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dompet Digital</title>
<link rel="manifest" href="manifest.json">
<style>
* { box-sizing: border-box; margin:0; padding:0; }
body {
  font-family: "Poppins", Arial, sans-serif;
  background: linear-gradient(135deg, #74ebd5, #9face6);
  min-height: 100vh;
  display: flex;
  justify-content: center;
  align-items: flex-start;
  padding: 20px;
}
.container {
  background: white;
  width: 100%;
  max-width: 520px;
  padding: 25px;
  border-radius: 20px;
  box-shadow: 0 8px 25px rgba(0,0,0,0.2);
}
h1 { text-align: center; margin-bottom: 20px; color: #333; }
h2 { margin-top: 20px; color:#333; }
.saldo-box { display: flex; flex-direction: column; gap:12px; margin-bottom:20px; }
.saldo-item { padding:14px; border-radius:14px; text-align:center; color:white; }
.saldo-cash { background:#3b82f6; }       /* biru */
.saldo-ewallet { background:#10b981; }   /* hijau */
.saldo-keluar { background:#ef4444; }    /* merah */
.saldo-total { background:#8b5cf6; }     /* ungu */
.saldo-item span { font-size:13px; }
.saldo-item p { font-size:18px; font-weight:bold; margin-top:5px; }
input, select, button { padding:10px; margin:6px 0; width:100%; font-size:14px; border-radius:10px; border:1px solid #ccc; }
button { cursor:pointer; border:none; color:white; font-weight:bold; }
.btn-add { background:green; margin-top:5px; }
.btn-reset { background:red; }
table { border-collapse: collapse; width:100%; margin-top:12px; font-size:13px; display:none; }
th, td { border:1px solid #ccc; padding:6px; text-align:left; }
th { background:#eee; }
</style>
</head>
<body>
<div class="container">
<h1>ðŸ’° Dompet Digital</h1>

<!-- Saldo -->
<div class="saldo-box">
  <div class="saldo-item saldo-cash">
    <span>Cash</span>
    <p id="cashSaldo">Rp450.000</p>
  </div>
  <div class="saldo-item saldo-ewallet">
    <span>E-wallet</span>
    <p id="ewalletSaldo">Rp0</p>
  </div>
  <div class="saldo-item saldo-keluar">
    <span>Uang Keluar</span>
    <p id="totalKeluar">Rp0</p>
  </div>
  <div class="saldo-item saldo-total">
    <span>Total</span>
    <p id="totalSaldo">Rp450.000</p>
  </div>
</div>

<h2>âž• Tambah Transaksi</h2>
<input type="text" id="desc" placeholder="Keterangan">
<input type="number" id="amount" placeholder="Jumlah (contoh: 20000)">
<select id="type">
  <option value="cash_masuk">Cash Masuk</option>
  <option value="ewallet_masuk">E-wallet Masuk</option>
  <option value="cash_keluar">Cash Keluar</option>
  <option value="ewallet_keluar">E-wallet Keluar</option>
</select>
<button class="btn-add" onclick="addTransaction()">Tambah</button>
<button class="btn-reset" onclick="resetTransactions()">Reset Semua</button>

<h2>ðŸ“„ Riwayat Transaksi</h2>
<select id="filterSelect" onchange="showTable(this.value)">
  <option value="">Pilih Riwayat</option>
  <option value="cashMasukTable">Cash Masuk</option>
  <option value="cashKeluarTable">Cash Keluar</option>
  <option value="ewalletMasukTable">E-wallet Masuk</option>
  <option value="ewalletKeluarTable">E-wallet Keluar</option>
</select>

<table id="cashMasukTable">
  <thead><tr><th>No</th><th>Tanggal</th><th>Keterangan</th><th>Jumlah</th></tr></thead>
  <tbody></tbody>
</table>

<table id="cashKeluarTable">
  <thead><tr><th>No</th><th>Tanggal</th><th>Keterangan</th><th>Jumlah</th></tr></thead>
  <tbody></tbody>
</table>

<table id="ewalletMasukTable">
  <thead><tr><th>No</th><th>Tanggal</th><th>Keterangan</th><th>Jumlah</th></tr></thead>
  <tbody></tbody>
</table>

<table id="ewalletKeluarTable">
  <thead><tr><th>No</th><th>Tanggal</th><th>Keterangan</th><th>Jumlah</th></tr></thead>
  <tbody></tbody>
</table>
</div>

<script>
// Ambil data dari LocalStorage atau default
let cash = parseInt(localStorage.getItem("cash")) || 450000;
let ewallet = parseInt(localStorage.getItem("ewallet")) || 0;
let transactions = JSON.parse(localStorage.getItem("transactions")) || [];

function updateSaldo() {
  document.getElementById("cashSaldo").innerText = "Rp" + cash.toLocaleString("id-ID");
  document.getElementById("ewalletSaldo").innerText = "Rp" + ewallet.toLocaleString("id-ID");
  
  let totalKeluar = transactions
    .filter(t => t.type.includes("keluar"))
    .reduce((sum, t) => sum + t.amount, 0);
  document.getElementById("totalKeluar").innerText = "-Rp" + totalKeluar.toLocaleString("id-ID");

  document.getElementById("totalSaldo").innerText = "Rp" + (cash + ewallet).toLocaleString("id-ID");
}

function renderHistory() {
  const cashMasuk = document.querySelector("#cashMasukTable tbody");
  const cashKeluar = document.querySelector("#cashKeluarTable tbody");
  const ewalletMasuk = document.querySelector("#ewalletMasukTable tbody");
  const ewalletKeluar = document.querySelector("#ewalletKeluarTable tbody");

  [cashMasuk, cashKeluar, ewalletMasuk, ewalletKeluar].forEach(tbody => tbody.innerHTML="");

  transactions.forEach((t,i)=>{
    let displayAmount = (t.type.includes("keluar") ? "-" : "") + "Rp" + t.amount.toLocaleString("id-ID");
    const row = `<tr>
      <td>${i+1}</td>
      <td>${t.tanggal}</td>
      <td>${t.desc}</td>
      <td>${displayAmount}</td>
    </tr>`;

    if(t.type === "cash_masuk") cashMasuk.innerHTML += row;
    else if(t.type === "cash_keluar") cashKeluar.innerHTML += row;
    else if(t.type === "ewallet_masuk") ewalletMasuk.innerHTML += row;
    else if(t.type === "ewallet_keluar") ewalletKeluar.innerHTML += row;
  });
}

function addTransaction() {
  const desc = document.getElementById("desc").value.trim();
  const amount = parseInt(document.getElementById("amount").value);
  const type = document.getElementById("type").value;

  if(!desc || isNaN(amount)) { alert("Isi semua kolom!"); return; }

  const today = new Date();
  const tanggal = today.toLocaleDateString("id-ID");

  if(type === "cash_masuk") cash += amount;
  else if(type === "ewallet_masuk") ewallet += amount;
  else if(type === "cash_keluar") {
    if(amount > cash){ alert("Saldo Cash tidak cukup!"); return; }
    cash -= amount;
  }
  else if(type === "ewallet_keluar") {
    if(amount > ewallet){ alert("Saldo E-wallet tidak cukup!"); return; }
    ewallet -= amount;
  }

  transactions.push({desc, type, amount, tanggal});

  // Simpan ke LocalStorage
  localStorage.setItem("cash", cash);
  localStorage.setItem("ewallet", ewallet);
  localStorage.setItem("transactions", JSON.stringify(transactions));

  updateSaldo();
  renderHistory();
  showTable(document.getElementById("filterSelect").value);

  document.getElementById("desc").value = "";
  document.getElementById("amount").value = "";
}

function resetTransactions() {
  if(confirm("Yakin reset semua?")) {
    transactions = [];
    cash = 0;
    ewallet = 0;
    localStorage.clear();
    updateSaldo();
    renderHistory();
    showTable(document.getElementById("filterSelect").value);
  }
}

function showTable(val){
  const tables = ["cashMasukTable","cashKeluarTable","ewalletMasukTable","ewalletKeluarTable"];
  tables.forEach(id=>{
    document.getElementById(id).style.display = (id===val) ? "table" : "none";
  });
}

// Init saat load
updateSaldo();
renderHistory();
</script>
</body>
</html>